# Scanner


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-nbdev-docments/blob/main/cjm_nbdev_docments/scanner.py#L19"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_export_cells

>  get_export_cells (nb_path:pathlib.Path)

*Extract all code cells from a notebook that have export directives*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>nb_path</td>
<td>Path</td>
<td>Path to the notebook file</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>List</strong></td>
<td><strong>List of cells with export directives</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-nbdev-docments/blob/main/cjm_nbdev_docments/scanner.py#L41"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract_definitions

>  extract_definitions (source:str)

*Extract function and class definitions from source code*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>source</td>
<td>str</td>
<td>Python source code</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>List</strong></td>
<td><strong>List of function/class definitions with
metadata</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-nbdev-docments/blob/main/cjm_nbdev_docments/scanner.py#L92"
target="_blank" style="float:right; font-size:smaller">source</a>

### scan_notebook

>  scan_notebook (nb_path:pathlib.Path,
>                     nbs_root:Optional[pathlib.Path]=None)

*Scan a notebook and extract all exported function/class definitions*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>nb_path</td>
<td>Path</td>
<td></td>
<td>Path to the notebook to scan</td>
</tr>
<tr>
<td>nbs_root</td>
<td>Optional</td>
<td>None</td>
<td>Root notebooks directory (for relative paths)</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>List</strong></td>
<td></td>
<td><strong>List of exported definitions with metadata</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-nbdev-docments/blob/main/cjm_nbdev_docments/scanner.py#L149"
target="_blank" style="float:right; font-size:smaller">source</a>

### scan_project

>  scan_project (nbs_path:Optional[pathlib.Path]=None,
>                    pattern:str='*.ipynb')

*Scan all notebooks in a project for exported definitions*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>nbs_path</td>
<td>Optional</td>
<td>None</td>
<td>Path to notebooks directory (defaults to config.nbs_path)</td>
</tr>
<tr>
<td>pattern</td>
<td>str</td>
<td>*.ipynb</td>
<td>Pattern for notebook files to scan</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>List</strong></td>
<td></td>
<td><strong>All exported definitions found in the project</strong></td>
</tr>
</tbody>
</table>

``` python
# Test scanning this project
definitions = scan_project()
print(f"Found {len(definitions)} exported definitions")
for defn in definitions[:5]:  # Show first 5
    print(f"- {defn['type']}: {defn['name']} in {defn['notebook']}")
```

    Found 59 exported definitions
    - FunctionDef: create_parser in cli.ipynb
    - FunctionDef: handle_autofix in cli.ipynb
    - FunctionDef: generate_report in cli.ipynb
    - FunctionDef: output_report in cli.ipynb
    - FunctionDef: main in cli.ipynb

``` python
# Test if nested folders would be detected
import tempfile
import shutil
from pathlib import Path

# Create a temporary directory structure to test nested scanning
with tempfile.TemporaryDirectory() as tmpdir:
    tmp_path = Path(tmpdir)
    
    # Create nested structure
    (tmp_path / "actions").mkdir()
    (tmp_path / "data_display").mkdir()
    
    # Create dummy notebooks
    dummy_nb = {
        "cells": [
            {"cell_type": "code", "source": "#| export\ndef test_func(): pass", "id": "cell-1"}
        ],
        "metadata": {},
        "nbformat": 4,
        "nbformat_minor": 5
    }
    
    import json
    
    # Create notebooks in root
    with open(tmp_path / "index.ipynb", "w") as f:
        json.dump(dummy_nb, f)
    
    # Create notebooks in subdirectories
    with open(tmp_path / "actions" / "button.ipynb", "w") as f:
        json.dump(dummy_nb, f)
    
    with open(tmp_path / "data_display" / "table.ipynb", "w") as f:
        json.dump(dummy_nb, f)
    
    # Test scanning
    print("Testing nested folder scanning:")
    notebooks = list(tmp_path.rglob("*.ipynb"))
    print(f"Created {len(notebooks)} test notebooks:")
    for nb in sorted(notebooks):
        print(f"  - {nb.relative_to(tmp_path)}")
    
    # Test scan_project with nested folders
    definitions = scan_project(nbs_path=tmp_path)
    print(f"\nscan_project found {len(definitions)} definitions")
    for defn in definitions:
        print(f"  - {defn['name']} in {defn['notebook']}")
```

    Testing nested folder scanning:
    Created 3 test notebooks:
      - actions/button.ipynb
      - data_display/table.ipynb
      - index.ipynb

    scan_project found 3 definitions
      - test_func in index.ipynb
      - test_func in data_display/table.ipynb
      - test_func in actions/button.ipynb

``` python
# Debug: Check what notebooks we're finding (including nested folders)
from nbdev.config import get_config
cfg = get_config()
nbs_path = Path(cfg.config_path) / cfg.nbs_path
notebooks = list(nbs_path.rglob("*.ipynb"))
print(f"Looking in: {nbs_path}")
print(f"Found {len(notebooks)} notebooks (including nested):")
for nb in sorted(notebooks):
    if not nb.name.startswith('_') and '.ipynb_checkpoints' not in str(nb):
        relative_path = nb.relative_to(nbs_path)
        print(f"  - {relative_path}")
        cells = get_export_cells(nb)
        if cells:
            print(f"    Export cells: {len(cells)}")
```

    Looking in: /home/runner/work/cjm-nbdev-docments/cjm-nbdev-docments/nbs
    Found 6 notebooks (including nested):
      - autofix.ipynb
        Export cells: 29
      - cli.ipynb
        Export cells: 6
      - core.ipynb
        Export cells: 15
      - index.ipynb
      - report.ipynb
        Export cells: 8
      - scanner.ipynb
        Export cells: 5
